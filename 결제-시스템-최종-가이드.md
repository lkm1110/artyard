# 💳 ArtYard 결제 시스템 최종 가이드

## 🇰🇷 **한국 서비스: Toss Payments 사용!** (추천)

Stripe는 한국을 지원하지 않으므로, **Toss Payments**를 사용하는 것을 강력히 추천합니다!

---

## 1️⃣ **Toss Payments vs Stripe 비교**

| 항목 | Toss Payments | Stripe |
|------|---------------|--------|
| 한국 지원 | ✅ 완벽 지원 | ❌ 미지원 |
| 수수료 | 3.3% | 3.2% |
| 간편결제 | ✅ 카카오페이, 네이버페이 | ❌ 없음 |
| 계좌이체 | ✅ 지원 | ❌ 없음 |
| 문서 | 🇰🇷 한글 | 🇺🇸 영어 |
| React Native | ✅ 지원 | ✅ 지원 |
| 글로벌 | ❌ 한국만 | ✅ 46개국 |

**결론:** 한국 서비스면 **Toss Payments가 100배 나음!** ✅

---

## 2️⃣ **Toss Payments 시작하기**

### **1. 회원가입**
```
https://www.tosspayments.com
→ 시작하기
→ 사업자 정보 입력 (개인도 가능!)
```

### **2. API 키 발급**
```
Dashboard → 개발자센터 → API 키
✅ 클라이언트 키
✅ 시크릿 키
```

### **3. 패키지 설치**
```bash
npm install @tosspayments/payment-sdk-react-native
```

### **4. 간단한 코드**
```typescript
import { TossPayments } from '@tosspayments/payment-sdk-react-native';

const handlePayment = async () => {
  const tossPayments = new TossPayments('클라이언트_키');
  
  await tossPayments.requestPayment('카드', {
    amount: 50000,
    orderId: 'order_123',
    orderName: '작품 구매',
    customerName: '홍길동',
    successUrl: 'artyard://payment/success',
    failUrl: 'artyard://payment/fail',
  });
};
```

**엄청 간단!** 😊

---

## 3️⃣ **아임포트 (대안)**

### **장점**
```
✅ 여러 PG사 통합 (토스, 나이스, KG이니시스 등)
✅ 하나의 코드로 여러 결제 수단
✅ React Native 지원
```

### **시작하기**
```
https://www.iamport.kr
→ 회원가입
→ PG사 선택 (토스페이먼츠 추천)
→ API 키 발급
```

---

## 4️⃣ **Stripe는 언제 쓰나?**

### **이런 경우에만 사용**
```
1. 글로벌 서비스 (해외 고객 많음)
2. 해외 법인 있음
3. 한국 외 지역 타겟
```

### **한국 서비스면?**
```
❌ Stripe 쓰지 마세요!
✅ Toss Payments 또는 아임포트 사용!
```

---

## 5️⃣ **코드 수정 필요?**

### **걱정 마세요!**

현재 코드는 **결제 서비스만 교체하면 됩니다:**

```typescript
// 기존 (Stripe)
import { useStripe } from '@stripe/stripe-react-native';

// 변경 (Toss Payments)
import { TossPayments } from '@tosspayments/payment-sdk-react-native';
```

**나머지 로직은 동일:**
- transactions 테이블
- 에스크로
- 정산
- 리뷰

모두 그대로 사용 가능! ✅

---

## 6️⃣ **추천 방안**

### **단계별 진행**

#### **Phase 1: MVP (지금)**
```
✅ Toss Payments 사용
✅ 한국 대학생 타겟
✅ 빠른 출시
```

#### **Phase 2: 성장 (6개월 후)**
```
✅ 결제 최적화
✅ 간편결제 추가
✅ 할부 지원
```

#### **Phase 3: 글로벌 (1년 후)**
```
✅ Stripe 추가 (글로벌용)
✅ 멀티 PG 지원
✅ 환율 자동 변환
```

---

## 7️⃣ **비용 비교**

### **50,000원 작품 판매 시**

#### **Toss Payments (3.3%)**
```
작품 가격: 50,000원
━━━━━━━━━━━━━━━━
플랫폼 수수료 (5%): -2,500원
Toss 수수료 (3.3%): -1,650원
━━━━━━━━━━━━━━━━
판매자 수령: 45,850원 (91.7%)
```

#### **Stripe (3.2% + 한국 미지원)**
```
❌ 사용 불가
```

**결론:** Toss가 더 저렴하고 편함! ✅

---

## 8️⃣ **Toss Payments 상세 가이드**

### **설치**
```bash
npm install @tosspayments/payment-sdk-react-native
```

### **환경변수 (.env)**
```env
EXPO_PUBLIC_TOSS_CLIENT_KEY=test_ck_...
TOSS_SECRET_KEY=test_sk_...
```

### **CheckoutScreen 수정**

```typescript
import { TossPayments } from '@tosspayments/payment-sdk-react-native';

const handlePayment = async () => {
  try {
    const tossPayments = new TossPayments(TOSS_CLIENT_KEY);
    
    // 1. Transaction 생성 (기존 로직 유지)
    const transaction = await createTransaction({
      artwork_id,
      shipping_address_id,
    });
    
    // 2. Toss Payments 결제 요청
    const result = await tossPayments.requestPayment('카드', {
      amount: transaction.total_amount,
      orderId: transaction.id,
      orderName: `${artwork.title} 구매`,
      customerName: user.handle,
      successUrl: `artyard://payment/success?orderId=${transaction.id}`,
      failUrl: `artyard://payment/fail?orderId=${transaction.id}`,
    });
    
    // 3. 결제 성공 처리
    if (result.success) {
      await confirmPayment(transaction.id, result.paymentKey);
      Alert.alert('결제 완료!', '작품을 성공적으로 구매했습니다.');
    }
    
  } catch (error) {
    Alert.alert('결제 실패', error.message);
  }
};
```

**기존 코드와 거의 동일!** 😊

---

## 9️⃣ **결론**

### **✅ 강력 추천: Toss Payments**

**이유:**
1. ✅ 한국 완벽 지원
2. ✅ 저렴한 수수료 (3.3%)
3. ✅ 간편결제 (카카오페이, 네이버페이)
4. ✅ 한글 문서
5. ✅ 빠른 정산 (D+1)
6. ✅ React Native 지원

### **❌ Stripe는 나중에**

- 글로벌 확장 시 추가
- 지금은 불필요
- 한국 미지원으로 사용 불가

---

## 🎯 **다음 단계**

```
1. ✅ SQL 실행 (완료!)
2. ✅ Toss Payments 회원가입
3. ✅ API 키 발급
4. ✅ 패키지 설치
5. ✅ CheckoutScreen 수정
6. ✅ 테스트!
```

---

## 📚 **참고 링크**

- [Toss Payments 개발자센터](https://docs.tosspayments.com/)
- [React Native SDK](https://docs.tosspayments.com/reference/widget-sdk#react-native)
- [아임포트](https://docs.iamport.kr/)

---

## 💬 **도움이 필요하면**

Toss Payments 연동 코드를 만들어드릴 수 있습니다!
알려주세요! 😊

---

**Toss Payments로 가세요!** 🚀🇰🇷

